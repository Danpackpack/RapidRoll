{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\prefabmanager.js"],"names":["cc","Class","extends","Component","properties","stairPre","Prefab","stairKillerPre","prefabLayer","Node","stairSpace","oStairY","stairCount","init","game","stairPool","NodePool","stairKillerPool","i","put","instantiate","currentStairY","newStair","director","getCollisionManager","enabled","onCollisionEnter","other","self","tag","desStair","node","desStairKiller","stairGroup","randD","random0To1","levDegree","size","get","addChild","stairX","stairY","setPosition"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,kBAAUL,GAAGM,MADL;AAERC,wBAAgBP,GAAGM,MAFX;AAGRE,qBAAaR,GAAGS,IAHR;;AAKRC,oBAAY,CALJ,EAKO;AACfC,iBAAS,CAND,EAMI;AACZC,oBAAY,CAPJ,CAOO;AAPP,KAHP;;AAaLC,UAAM,cAAUC,IAAV,EAAgB;AAClB,aAAKA,IAAL,GAAYA,IAAZ;AACA,aAAKC,SAAL,GAAiB,IAAIf,GAAGgB,QAAP,EAAjB;AACA,aAAKC,eAAL,GAAuB,IAAIjB,GAAGgB,QAAP,EAAvB;AACA,aAAI,IAAIE,IAAI,CAAZ,EAAeA,IAAI,CAAnB,EAAsBA,GAAtB,EAA0B;AACtB,iBAAKH,SAAL,CAAeI,GAAf,CAAmBnB,GAAGoB,WAAH,CAAe,KAAKf,QAApB,CAAnB;AACH;AACD,aAAI,IAAIa,IAAI,CAAZ,EAAeA,IAAI,CAAnB,EAAsBA,GAAtB,EAA0B;AACtB,iBAAKD,eAAL,CAAqBE,GAArB,CAAyBnB,GAAGoB,WAAH,CAAe,KAAKb,cAApB,CAAzB;AACH;AACD,aAAKc,aAAL,GAAqB,KAAKV,OAA1B,CAVkB,CAUgB;AAClC,aAAI,IAAIO,IAAI,CAAZ,EAAeA,IAAI,CAAnB,EAAsBA,GAAtB,EAA0B;AACtB,iBAAKI,QAAL;AACH;;AAEDtB,WAAGuB,QAAH,CAAYC,mBAAZ,GAAkCC,OAAlC,GAA4C,IAA5C;AACH,KA7BI;;AA+BLC,sBAAkB,0BAAUC,KAAV,EAAiBC,IAAjB,EAAuB;AACrC,YAAGD,MAAME,GAAN,KAAc,GAAjB,EAAqB;AACjB,iBAAKC,QAAL,CAAcH,MAAMI,IAApB;AACH;AACD,YAAGJ,MAAME,GAAN,KAAc,GAAjB,EAAqB;AACjB,iBAAKG,cAAL,CAAoBL,MAAMI,IAA1B;AACH;AACJ,KAtCI;;AAwCLT,cAAU,oBAAY;AAClB,aAAKV,UAAL,IAAmB,CAAnB;AACA,YAAIqB,aAAa,IAAjB;AACA,YAAIC,QAAQlC,GAAGmC,UAAH,EAAZ;AACA,YAAGD,QAAQ,KAAKpB,IAAL,CAAUsB,SAArB,EAA+B;AAC3B,gBAAG,KAAKrB,SAAL,CAAesB,IAAf,KAAwB,CAA3B,EAA6B;AACzBJ,6BAAa,KAAKlB,SAAL,CAAeuB,GAAf,EAAb;AACH,aAFD,MAEO;AACHL,6BAAajC,GAAGoB,WAAH,CAAe,KAAKf,QAApB,CAAb;AACH;AACJ,SAND,MAMO,IAAG6B,SAAS,KAAKpB,IAAL,CAAUsB,SAAtB,EAAgC;AACnC,gBAAG,KAAKnB,eAAL,CAAqBoB,IAArB,KAA8B,CAAjC,EAAmC;AAC/BJ,6BAAa,KAAKhB,eAAL,CAAqBqB,GAArB,EAAb;AACH,aAFD,MAEO;AACHL,6BAAajC,GAAGoB,WAAH,CAAe,KAAKb,cAApB,CAAb;AACH;AACJ;AACD,aAAKC,WAAL,CAAiB+B,QAAjB,CAA0BN,UAA1B;;AAEA,YAAIO,SAAS,MAAMxC,GAAGmC,UAAH,EAAN,GAAuB,GAApC;AACA,YAAIM,SAAS,KAAKpB,aAAlB;AACAY,mBAAWS,WAAX,CAAuBF,MAAvB,EAA+BC,MAA/B;;AAEA,aAAKpB,aAAL,IAAsB,KAAKX,UAA3B;AACA;;AAEA;AACH,KAnEI;;AAqELoB,cAAU,kBAAUC,IAAV,EAAgB;AACtB,aAAKhB,SAAL,CAAeI,GAAf,CAAmBY,IAAnB;AACA,aAAKT,QAAL;AACH,KAxEI;;AA0ELU,oBAAgB,wBAAUD,IAAV,EAAgB;AAC5B,aAAKd,eAAL,CAAqBE,GAArB,CAAyBY,IAAzB;AACA,aAAKT,QAAL;AACH;AA7EI,CAAT","file":"prefabmanager.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        stairPre: cc.Prefab,\r\n        stairKillerPre: cc.Prefab,\r\n        prefabLayer: cc.Node,\r\n\r\n        stairSpace: 0, //上下梯子间距\r\n        oStairY: 0, //第一个梯子位置\r\n        stairCount: 0, //梯子数量\r\n    },\r\n\r\n    init: function (game) {\r\n        this.game = game;\r\n        this.stairPool = new cc.NodePool();\r\n        this.stairKillerPool = new cc.NodePool();\r\n        for(var i = 0; i < 8; i++){\r\n            this.stairPool.put(cc.instantiate(this.stairPre));\r\n        }\r\n        for(var i = 0; i < 4; i++){\r\n            this.stairKillerPool.put(cc.instantiate(this.stairKillerPre));\r\n        }\r\n        this.currentStairY = this.oStairY;//当前梯子位置\r\n        for(var i = 0; i < 8; i++){\r\n            this.newStair();\r\n        }\r\n\r\n        cc.director.getCollisionManager().enabled = true;\r\n    },\r\n\r\n    onCollisionEnter: function (other, self) {\r\n        if(other.tag === 100){\r\n            this.desStair(other.node);\r\n        }\r\n        if(other.tag === 101){\r\n            this.desStairKiller(other.node);\r\n        }\r\n    },\r\n\r\n    newStair: function () {\r\n        this.stairCount += 1;\r\n        let stairGroup = null;\r\n        var randD = cc.random0To1();\r\n        if(randD > this.game.levDegree){\r\n            if(this.stairPool.size() > 0){\r\n                stairGroup = this.stairPool.get();\r\n            } else {\r\n                stairGroup = cc.instantiate(this.stairPre);\r\n            }\r\n        } else if(randD <= this.game.levDegree){\r\n            if(this.stairKillerPool.size() > 0){\r\n                stairGroup = this.stairKillerPool.get();\r\n            } else {\r\n                stairGroup = cc.instantiate(this.stairKillerPre);\r\n            }\r\n        }\r\n        this.prefabLayer.addChild(stairGroup);\r\n\r\n        var stairX = 500 * cc.random0To1() -250;\r\n        var stairY = this.currentStairY;\r\n        stairGroup.setPosition(stairX, stairY);\r\n\r\n        this.currentStairY -= this.stairSpace;\r\n        //cc.log(stairX);\r\n        \r\n        //cc.log(stairY);\r\n    },\r\n\r\n    desStair: function (node) {\r\n        this.stairPool.put(node);\r\n        this.newStair();\r\n    },\r\n\r\n    desStairKiller: function (node) {\r\n        this.stairKillerPool.put(node);\r\n        this.newStair();\r\n    }\r\n});\r\n"]}